(function(e){function t(t){for(var r,s,i=t[0],l=t[1],c=t[2],u=0,d=[];u<i.length;u++)s=i[u],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&d.push(n[s][0]),n[s]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);p&&p(t);while(d.length)d.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],r=!0,i=1;i<a.length;i++){var l=a[i];0!==n[l]&&(r=!1)}r&&(o.splice(t--,1),e=s(s.s=a[0]))}return e}var r={},n={app:0},o=[];function s(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=r,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(a,r,function(t){return e[t]}.bind(null,r));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/TemperatureMap/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var p=l;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"085c":function(e,t,a){"use strict";var r=a("1cc1"),n=a.n(r);n.a},"1cc1":function(e,t,a){},"559f":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("temperature-map")],1)},o=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"map"},[a("div",{staticClass:"map__title"},[e._v(" КАРТА РАСПРЕДЕЛЕНИЯ ТЕМПЕРАТУР ")]),a("div",{staticClass:"map__controls"},[a("div",{staticClass:"map__controls__control"},[a("div",{staticClass:"map__controls__control__label"},[e._v(" Уровень интерполяции: ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.splitLevelTemp,expression:"splitLevelTemp"}],staticClass:"map__controls__control__input",domProps:{value:e.splitLevelTemp},on:{change:e.handleSplitLevelChange,input:function(t){t.target.composing||(e.splitLevelTemp=t.target.value)}}})]),a("div",{staticClass:"map__controls__control"},[a("div",{staticClass:"map__controls__control__label"},[e._v(" Градаций цвета: ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.colorLevelsTemp,expression:"colorLevelsTemp"}],staticClass:"map__controls__control__input",domProps:{value:e.colorLevelsTemp},on:{change:e.handleColorLevelsChange,input:function(t){t.target.composing||(e.colorLevelsTemp=t.target.value)}}})])]),a("l-map",{ref:"temperatureMap",staticClass:"map__container",attrs:{zoom:e.zoom,center:e.center,options:{zoomControl:!0}},on:{zoomend:e.getMapData,moveend:e.getMapData}},[a("l-tile-layer",{attrs:{url:e.url}}),a("l-geo-json",{ref:"geoJson",attrs:{geojson:e.geojson,options:{style:e.tileStyles},zIndex:1e3}}),e.legendVisible?a("l-control",[e.minTemp&&e.maxTemp?a("legend-component",{attrs:{minVal:e.minTemp,maxVal:e.maxTemp,levels:+e.colorLevels}}):e._e()],1):e._e()],1),a("div",{class:"map__button "+(e.getDataDisabled?"disabled":""),on:{click:e.handleButtonClick}},[e._v(" Показать температуру ")]),e.isLoading?a("loader-component"):e._e()],1)},i=[],l=(a("99af"),a("4160"),a("d81d"),a("159b"),a("96cf"),a("89ba")),c=a("2699"),p=a("a40a"),u=a("044a"),d=a("2253"),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"legend"},[a("div",{staticClass:"legend__title"},[e._v(" Темпераура °C ")]),e._l(e.legendData,(function(t){return a("div",{key:t.label,staticClass:"legend__item"},[a("div",{staticClass:"legend__item__color",style:{background:t.color}}),a("div",{staticClass:"legend__item__label"},[e._v(" "+e._s(t.label)+" ")])])}))],2)},h=[],v=(a("a9e3"),{props:{minVal:{type:Number,required:!0},maxVal:{type:Number,required:!0},levels:{type:Number,required:!0}},computed:{legendData:function(){for(var e=[],t=(this.maxVal-this.minVal)/this.levels,a=0;a<this.levels;a++){var r=Math.round(100*(this.minVal+t*a))/100,n=Math.round(100*(this.minVal+t*(a+1)))/100;e.push({color:"rgb(0, ".concat(256*a/this.levels,", 0)"),label:"".concat(r,"-").concat(n)})}return e}}}),f=v,g=(a("fbfa"),a("2877")),_=Object(g["a"])(f,m,h,!1,null,"770a8e32",null),b=_.exports,y=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},C=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"loader"},[a("div",{staticClass:"loader__inner"},[e._v(" Данные загружаются ... ")])])}],L={},x=L,T=(a("085c"),Object(g["a"])(x,y,C,!1,null,"6d5b9e5e",null)),D=T.exports;function w(e,t,a){var r=a[0],n=e[0][0],o=e[1][0],s=a[1],i=e[0][1],l=e[2][1],c=o-n,p=l-i,u=t[0]*(o-r)/c+t[1]*(r-n)/c,d=t[2]*(o-r)/c+t[3]*(r-n)/c;return u*(l-s)/p+d*(s-i)/p}function A(e,t,a,r){var n=t-e,o=a-e;return"rgb(0, ".concat(256*Math.floor(r*o/n)/r,", 0)")}var j=273.15,O="60acc8160072c82960b8bb8ef3f1b49c",P={components:{LMap:c["a"],LTileLayer:p["a"],LGeoJson:u["a"],LControl:d["a"],LegendComponent:b,LoaderComponent:D},data:function(){return{xPointsData:9,yPointsData:6,splitLevel:20,colorLevels:6,splitLevelTemp:20,colorLevelsTemp:6,url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png",zoom:5,centerLat:55.7422,centerLng:37.57,mapBounds:null,geojson:{type:"FeatureCollection",features:[]},tileStyles:function(e){return e.properties||(e.properties={}),e.properties.style||(e.properties.style={}),e.properties.style},minTemp:null,maxTemp:null,legendVisible:!1,getDataDisabled:!1,dataCoordsArray:[],dataAreasArray:[],viewCoordsArray:[],isLoading:!1}},computed:{center:function(){return[this.centerLat,this.centerLng]}},mounted:function(){this.getMapData()},methods:{handleSplitLevelChange:function(){this.splitLevel=this.splitLevelTemp,this.getMapData()},handleColorLevelsChange:function(){this.colorLevels=this.colorLevelsTemp,this.getMapData()},enableDataGetting:function(){this.getDataDisabled=!1},handleButtonClick:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.getDataDisabled){e.next=2;break}return e.abrupt("return");case 2:return this.getDataDisabled=!0,setTimeout(this.enableDataGetting,6e4),e.next=6,this.getNewTemperatureData();case 6:t=e.sent,t&&(this.geojson={type:"FeatureCollection",features:t});case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getMapData:function(){var e=this;this.$nextTick((function(){e.legendVisible=!1,e.geojson={type:"FeatureCollection",features:[]},e.mapBounds=e.$refs.temperatureMap.mapObject.getBounds();var t=e.$refs.temperatureMap.mapObject.getCenter();e.centerLat=t.lat,e.centerLng=t.lng,e.setCoordsArrays()}))},setCoordsArrays:function(){var e=this,t=+(this.mapBounds._northEast.lng-this.mapBounds._southWest.lng)/(this.xPointsData-1),a=+(this.mapBounds._northEast.lat-this.mapBounds._southWest.lat)/(this.yPointsData-1),r=t/+this.splitLevel,n=a/+this.splitLevel;this.dataCoordsArray=[],this.dataAreasArray=[],this.viewCoordsArray=[];for(var o=0;o<this.yPointsData;o++)for(var s=0;s<this.xPointsData;s++)this.dataCoordsArray.push([this.mapBounds._southWest.lng+s*t,this.mapBounds._northEast.lat-o*a]);var i=0;this.dataCoordsArray.forEach((function(t,a){if((a+1)%e.xPointsData!==0&&!(a>e.dataCoordsArray.length-e.xPointsData-1)){e.dataAreasArray.push([a,a+1,a+e.xPointsData,a+e.xPointsData+1]);for(var o=0;o<+e.splitLevel;o++)for(var s=0;s<+e.splitLevel;s++){var l=[t[0]+s*r,t[1]-o*n];e.viewCoordsArray.push({type:"Feature",properties:{square:i,style:{stroke:!1,fillOpacity:.5}},geometry:{type:"Polygon",coordinates:[[l,[l[0]+r,l[1]],[l[0]+r,l[1]+n],[l[0],l[1]+n],l]]}})}i+=1}}))},getNewTemperatureData:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a,r,n,o=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.isLoading=!0,e.prev=1,t=[],this.minTemp=null,this.maxTemp=null,a=0;case 6:if(!(a<this.dataCoordsArray.length)){e.next=17;break}return e.next=9,this.$axios.get("?lat=".concat(this.dataCoordsArray[a][1],"&lon=").concat(this.dataCoordsArray[a][0],"&APPID=").concat(O));case 9:r=e.sent,n=r.data.main.temp-j,this.minTemp=this.minTemp&&this.minTemp<n?this.minTemp:n,this.maxTemp=this.maxTemp&&this.maxTemp>n?this.maxTemp:n,t.push(n);case 14:a++,e.next=6;break;case 17:return this.viewCoordsArray.forEach((function(e){e.properties.square;var a=o.dataAreasArray[e.properties.square].map((function(e){return o.dataCoordsArray[e]})),r=o.dataAreasArray[e.properties.square].map((function(e){return t[e]})),n=e.geometry.coordinates[0][0],s=w(a,r,n),i=A(o.minTemp,o.maxTemp,s,o.colorLevels);e.properties.style.fillColor=i})),this.legendVisible=!0,this.isLoading=!1,e.abrupt("return",JSON.parse(JSON.stringify(this.viewCoordsArray)));case 23:return e.prev=23,e.t0=e["catch"](1),this.isLoading=!1,console.error(e.t0),e.abrupt("return",!1);case 28:case"end":return e.stop()}}),e,this,[[1,23]])})));function t(){return e.apply(this,arguments)}return t}()}},M=P,k=(a("bb9c"),Object(g["a"])(M,s,i,!1,null,"5039307e",null)),V=k.exports,B={name:"app",components:{TemperatureMap:V}},S=B,$=(a("5c0b"),Object(g["a"])(S,n,o,!1,null,null,null)),E=$.exports,N=a("e11e"),q=a("bc3a"),z=a.n(q);a("6cc5");z.a.defaults.baseURL="https://api.openweathermap.org/data/2.5/weather",delete N["Icon"].Default.prototype._getIconUrl,N["Icon"].Default.mergeOptions({iconRetinaUrl:a("584d"),iconUrl:a("6397"),shadowUrl:a("e2b9")}),r["a"].config.productionTip=!1,r["a"].prototype.$axios=z.a;var J={render:function(e){return e(E)}};new r["a"](J).$mount("#app")},"5c0b":function(e,t,a){"use strict";var r=a("9c0c"),n=a.n(r);n.a},"96e7":function(e,t,a){},"9c0c":function(e,t,a){},bb9c:function(e,t,a){"use strict";var r=a("96e7"),n=a.n(r);n.a},fbfa:function(e,t,a){"use strict";var r=a("559f"),n=a.n(r);n.a}});
//# sourceMappingURL=app.1a5f0bba.js.map